---
title: "DataExploration"
output: html_document
date: "2024-10-10"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.





if (interactive == TRUE){
  total_individuals <- length(unique(data_other$ID))
  plot_trace_examples <- plotTraceExamples(behaviours = unique(data_other$Activity), 
                                         data = data_other, 
                                         individuals = 9,
                                         n_samples = 250, 
                                         n_col = 4)

  # regroup the behaviours 
  visualisation_data <- data_other %>% mutate(Activity =
                                              ifelse(Activity %in% c("swimming", "moving", "out", "lying"), Activity, "Other")) %>%
                                     filter(!Activity == "Other")

  plot_activity_by_ID <- plotActivityByID(data = visualisation_data, 
                                        frequency = sample_rate, 
                                        colours = length(unique(data_other$ID)))

  # specify the target behaviours here
  plot_behaviour_durations <- BehaviourDuration(data = data_other, 
                                              sample_rate = sample_rate, 
                                              target_activities = target_activities)
  
  plot <- plot_behaviour_durations$duration_plot
  stats <- plot_behaviour_durations$duration_stats
}

 
 
 
 if(interactive == TRUE){
  # Using a UMAP, plot samples of the behaviours to determine which are easy to find
  vis_feature_data <- feature_data[1:10000,] %>%
    select_if( ~ !is.na(.[1])) %>% na.omit() %>%
    mutate(Activity =
             ifelse(Activity %in% c("swimming", "moving", "out", "lying"), Activity, "Other"))
  numeric_features <- vis_feature_data %>% select(-c('Activity', 'Time', 'ID'))
  labels <- vis_feature_data %>% select('Activity')


  UMAP <- UMAPReduction(
    numeric_features,
    labels,
    minimum_distance = 0.01,
    num_neighbours = 5,
    shape_metric = 'manhattan',
    spread = 2
  )
  
  UMAP$UMAP_2D_plot
  UMAP$UMAP_3D_plot
}
  
